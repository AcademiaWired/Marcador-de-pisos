<style>
  textarea {
    width: 100%;
    height: 45%;
  }
  * {
    font-size: 20;
  }
</style>

<textarea id="input"></textarea>
<br/><br/>
<button onclick="send()">Solve</button>
<pre id="output"></pre>

<script>
  const input = document.querySelector('#input')
  const output = document.querySelector('#output')

  input.value = '◫◪◫◫◫\n◫◫▩◪◫'

  function send() {
    output.textContent = ''
    const inputValue = input.value.split('\n')
      .map(s => s.replace(/\s/g, ''))
      .filter(s => s != '')
    let matrix = inputValue
    if(inputValue[0][0] == '[') // if the input string is in array format
      matrix = JSON.parse(inputValue.join(''))
    const n = matrix[0].length 
    console.log(`FETCH /solve`)
    fetch('/solve', {
      method: 'post',
      headers: {
        "Content-type": "application/json; charset=UTF-8"
      },
      body: JSON.stringify({matrix: matrix})
    })
    .then(res => res.json())
    .then(data => {
      console.log(data)
      updateOutput(data, n)
    })
    .catch(err => {
      console.log(err)
    })

    function updateOutput({success, numVariables, numConstraints, time, iterations, branchAndBoundNodes, objectiveValue, solution}, n) {
      output.textContent = `
        Success: ${success}
        Objective value: ${objectiveValue}
        Time: ${time} ms
        Variables: ${numVariables}
        Constraints: ${numConstraints}
        Iterations: ${iterations}
        Branch and Bound nodes: ${branchAndBoundNodes}
        Solution: 
        ${arrayToStringMatrix(solution, n)}
      `.replace(/^\s+|\s+$/gm, '')
    }

    function arrayToStringMatrix(v, n) {
      let res = '', row = []
      for(let i = 0; i < v.length; i++) {
        row.push(v[i])
        if((i+1) % n == 0) {
          res += `${JSON.stringify(row)}\n`
          row = []
        }
      }
      return res
    }
  }
</script>